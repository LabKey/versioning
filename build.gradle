buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath "org.jfrog.buildinfo:build-info-extractor-gradle:4.1.1"
    }
}

apply plugin: 'groovy'
apply plugin: 'maven-publish'
//apply plugin: org.jfrog.gradle.plugin.artifactory.ArtifactoryPlugin
apply plugin: 'com.jfrog.artifactory'

repositories {
    jcenter()
}

dependencies {
    compile gradleApi()
    compile localGroovy()
    compile 'org.ajoberstar:grgit:1.6.0'
    compile 'org.tmatesoft.svnkit:svnkit:1.8.12'
}

/**
 * Plug-in publication
 */
publishing {
    publications {
        mavenJava (MavenPublication) {
            groupId 'net.nemerosa'
            artifactId 'versioning'
            version '2.2'
            from components.java
        }
    }
}

artifactory {
    contextUrl =  "${artifactory_contextUrl}"
    publish {
        repository {
            repoKey = "libs-release-local"
             username = "${artifactory_user}"
             password = "${artifactory_password}"
        }
        defaults {
            publications('mavenJava')
        }
    }
    resolve {
        repository {
            repoKey = "libs-release"
        }
    }
}


/**
 * Wrapper definition
 */
task wrapper(type: Wrapper) {
    gradleVersion = '2.13'
}

test {
    ignoreFailures = true

    //Skips all tests
    exclude "**/*.class"

    environment "GIT_TEST_BRANCH", "feature/456-cute"
    environment "SVN_TEST_BRANCH", "feature-456-cute"
}